!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PjsPeerflowAdapter=t():e.PjsPeerflowAdapter=t()}(this,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===r(o)?o:String(o)),i)}var o}e.d(t,{PjsPeerflowAdapter:()=>d});const i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={}}var t,r;return t=e,r=[{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e]=this.listeners[e].concat(t)}},{key:"off",value:function(e,t){var r;return!!this.listeners[e]&&(r=this.listeners[e].indexOf(t),this.listeners[e]=this.listeners[e].slice(),this.listeners[e].splice(r,1),r>-1)}},{key:"trigger",value:function(e){var t,r,n,i;if(t=this.listeners[e])if(2===arguments.length)for(n=t.length,r=0;r<n;++r)t[r].call(this,arguments[1]);else{for(i=[],r=arguments.length,r=1;r<arguments.length;++r)i.push(arguments[r]);for(n=t.length,r=0;r<n;++r)t[r].apply(this,i)}}},{key:"dispose",value:function(){this.listeners={}}}],r&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e){var t=this;this.player=e,this.media={},this.currentSrc=void 0,this.paused=!1,this.ended=!1,this.observers={},Object.defineProperty(this,"playing",{get:function(){return this.player.api("playing")}}),Object.defineProperty(this,"src",{set:function(e){this.autoplay||this.playing?this.player.api("play",e):this.player.api("file",e),this.currentSrc=e},get:function(){return this.currentSrc}}),Object.defineProperty(this.media,"src",{set:function(e){this.autoplay||this.playing?this.player.api("play",e):this.player.api("file",e),this.currentSrc=e}.bind(this),get:function(){return this.currentSrc}.bind(this)}),Object.defineProperty(this,"currentTime",{set:function(e){document.getElementById(this.player.api("id")).getElementsByTagName("video")[0].currentTime=e},get:function(){return this.player.api("time")}}),Object.defineProperty(this.media,"currentTime",{set:function(e){document.getElementById(this.player.api("id")).getElementsByTagName("video")[0].currentTime=e}.bind(this),get:function(){return this.player.api("time")}.bind(this)}),Object.defineProperty(this.media,"buffered",{get:function(){var e=document.getElementById(this.player.api("id")).getElementsByTagName("video")[0];return e?e.buffered:e}.bind(this)}),Object.defineProperty(this,"playbackRate",{set:function(e){var t=document.getElementById(this.player.api("id")).getElementsByTagName("video")[0];t.playbackRate!=e&&(t.playbackRate=e)},get:function(){return t.player.api("speed")}}),Object.defineProperty(this,"autoplay",{get:function(){return 1==t.player.api("v","autoplay")}})}o.prototype.handleEvent=function(e,t){var r={start:"loadstart",play:"play",pause:"pause",duration:"progress",time:"timeupdate",buffering:"stalled",waiting:"waiting",error:"error",end:"ended"};if(r[e]){var n=r[e];this.emit(n,t)}},o.prototype.addEventListener=function(e,t){this.observers[e]||(this.observers[e]=[]),this.observers[e].push({callback:t})},o.prototype.once=function(e,t){this.observers[e]||(this.observers[e]=[]),this.observers[e].push({callback:t,once:!0})},o.prototype.emit=function(e,t){this.observers[e]&&(this.observers[e]=this.observers[e].filter((function(e){return e.callback(t),!e.once})))},o.prototype.stop=function(){this.player.api("stop")},o.prototype.pause=function(){this.player.api("pause")},o.prototype.play=function(){this.player.api("play")},o.prototype.destroy=function(){this.player.api("destroy")};const s=o,a="1.0.4";function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function y(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===u(t)?t:String(t)}console.log("PlayerJS Adapter ",a,"loaded.");var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(h,e);var t,r,n,i,o=(n=h,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(n);if(i){var r=f(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}(this,e)});function h(e,t,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),y(c(n=o.call(this)),"onPpspReadyHandler",(function(){n.videoObs.autoplay&&setTimeout(n.startChannel.bind(c(n)),100),n.trigger("ready")})),y(c(n),"onPpspTokenError",(function(e){n.trigger("onTokenError",e)})),n.ver=a,window&&(window.pa=a),n.video=e,n.swarmConfig=r,n.videoObs=new s(n.video),n.ppsp=new Ppsp(n.videoObs,t,!1),n.ppsp.on("ready",n.onPpspReadyHandler.bind(c(n))),n.ppsp.on("onTokenError",n.onPpspTokenError.bind(c(n))),n.initPlayerjsEvents(),n}return t=h,(r=[{key:"play",value:function(){this.video.play()}},{key:"pause",value:function(){this.video.pause()}},{key:"startChannel",value:function(e){e&&(this.swarmConfig=e),this.swarmConfig&&this.swarmConfig.swarmID&&this.ppsp.startChannel(this.swarmConfig)}},{key:"handlePlayerEvents",value:function(e,t){this.videoObs.handleEvent(e,t),"start"!==e||this.videoObs.playing||this.videoObs.autoplay||setTimeout(this.startChannel.bind(this),0)}},{key:"initPlayerjsEvents",value:function(){var e=this;if(window){var t=window.PlayerjsEvents;window.PlayerjsEvents=function(r,n,i){if(t)try{t(r,n,i)}catch(e){}e.handlePlayerEvents(r,i)}}}}])&&p(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(i);return t.PjsPeerflowAdapter})()));